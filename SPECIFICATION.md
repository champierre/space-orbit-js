# Space Orbit 仕様書

## 概要
Space Orbitは未就学児向けの軌道設計アプリケーションです。ユーザーは自由に宇宙船を発射し、地球と月の重力に従って動く軌道を眺めることができます。[Space Orbit](https://zenn.dev/ta168/articles/space-orbit_app)を参考に実装しています。

## 機能要件

### 基本機能
- 画面上の任意の場所をクリック/タップすることで宇宙船を発射できる
- 発射された宇宙船は地球と月の重力に従い運動を続ける
- 地球をクリック/タップすると全ての宇宙船を消去できる
- 地球重力を脱するスピードを持つ宇宙船の軌道は水色で表示される
- 地球重力に捉えられている宇宙船の軌道は緑色で表示される
- 月スイングバイで一定の加速をすると宇宙船にキラキラエフェクトが表示される
- 宇宙船が地球または月に衝突すると爆発エフェクトが表示され、宇宙船は消滅する

### 表示要素
- 中央に青い地球を配置
- 地球の周りを黄色い月が周回
- 宇宙船の軌道を線で表示
- 宇宙船自体は白い点で表示
- 背景は黒（宇宙空間）

### 制限事項
- 宇宙船の数に制限はありませんが、多すぎるとパフォーマンスが低下する場合があります
- 地球と月は実際の縮尺よりも大きめ（5倍）に表示
- 実際の軌道設計には使用しないこと

## 技術仕様

### 物理モデル
- 地球と月の重力のみを考慮した運動方程式を使用
- 地球中心慣性座標系を採用
- 運動方程式の解法にはRunge-Kutta法（RK4）を使用

### エネルギー計算
- 各宇宙船の地心エネルギーε（地球に対する運動エネルギーと位置エネルギーの和）を計算
  ```
  ε = (1/2)v² - μE/rE
  ```
  - v: 宇宙船の地球に対する速度の大きさ
  - μE: 地球の重力定数
  - rE: 宇宙船の地球からの距離

### 軌道の色分け
- 地心エネルギーεが負の値の場合：緑色（地球重力に捉えられている状態）
- 地心エネルギーεが正の値の場合：水色（地球重力圏から脱している状態）

### エフェクト
- 地心エネルギーεの単位時間あたりの増加量が一定以上になっている間、キラキラエフェクトを表示
- これは主に月のスイングバイによる加速時に発生
- 宇宙船が地球または月に衝突した場合、白色の爆発エフェクトを表示

## 実装方針
- JavaScriptとp5.jsを使用して実装
- 描画処理はp5.jsのキャンバス上で行う
- 数値計算（Runge-Kutta法）はJavaScriptで実装
- レスポンシブデザインで様々な画面サイズに対応
